
---

# Чеклист критических тест-кейсов — Local Chat

## Авторизация

| ID | Сценарий | Шаги | Ожидаемый результат |
|----|----------|------|---------------------|
| A1 | Успешный вход | Ввести корректные логин/пароль → "Войти" | Редирект на `/`, sidebar с чатами |
| A2 | Неверный пароль | Ввести неверный пароль → "Войти" | Ошибка "Неверный логин или пароль", остаёмся на `/login` |
| A3 | Выход | Профиль → "Выйти" | Редирект на `/login`, токен удалён |
| A4 | Истечение сессии | Подождать 24ч (или удалить сессию в БД) → любое действие | Редирект на `/login`, toast "Сессия истекла" |
| A5 | Одна активная сессия | Войти с устройства A, затем с устройства B | Сессия на устройстве A инвалидирована |

---

## Чаты и сообщения

| ID | Сценарий | Шаги | Ожидаемый результат |
|----|----------|------|---------------------|
| C1 | Создание чата | На главной ввести сообщение → отправить | Создан "Чат №N", сообщение отправлено, ответ LLM получен |
| C2 | Продолжение чата | Открыть существующий чат → отправить сообщение | Сообщение добавлено, ответ LLM в контексте диалога |
| C3 | История сообщений | Открыть существующий чат | Все предыдущие сообщения отображаются в правильном порядке |
| C4 | Удаление чата | Hover на чат → корзина → подтвердить | Чат удалён, редирект на `/` |
| C5 | Регенерация | Иконка регенерации на последнем ответе | Старый ответ заменён новым |
| C6 | Отмена запроса | Отправить сообщение → "Отмена" | Загрузка прервана, сообщение пользователя осталось |
| C7 | Копирование | Иконка копирования на ответе ассистента | Текст в буфере обмена, toast "Скопировано" |

---

## Обработка ошибок

| ID | Сценарий | Шаги | Ожидаемый результат |
|----|----------|------|---------------------|
| E1 | Таймаут LLM | Отправить сообщение, LLM не отвечает 150+ сек | Toast "Превышено время ожидания", кнопка "Повторить" |
| E2 | n8n недоступен | Остановить n8n контейнер → отправить сообщение | Toast "Нейросеть недоступна", кнопка "Повторить" |
| E3 | Ошибка от LLM | n8n возвращает status: error | Toast с текстом ошибки, кнопка "Повторить" |
| E4 | Нет интернета | Отключить сеть → отправить сообщение | Toast "Ошибка соединения" |

---

## Безопасность

| ID | Сценарий | Шаги | Ожидаемый результат |
|----|----------|------|---------------------|
| S1 | Доступ к чужому чату | Вручную перейти на `/chat/{чужой_id}` | 403 Forbidden или редирект |
| S2 | API без токена | Запрос к `/api/chats` без Authorization header | 401 Unauthorized |
| S3 | Невалидный токен | Запрос с произвольным токеном | 401 Unauthorized |

---

## Mobile

| ID | Сценарий | Шаги | Ожидаемый результат |
|----|----------|------|---------------------|
| M1 | Открытие sidebar | Тап на "гамбургер" | Sidebar выезжает, overlay затемняет контент |
| M2 | Закрытие sidebar | Тап вне sidebar или на чат | Sidebar закрывается |
| M3 | Отправка сообщения | Ввести текст → отправить | Работает как на desktop |
| M4 | Длинный ответ | Получить длинный ответ от LLM | Скролл работает, текст читаем |

---

**Всего: 21 критический тест-кейс**